import React from 'react';
import {
  CriticalRiskIcon,
  AngleDoubleUpIcon,
  EqualsIcon,
  AngleDoubleDownIcon,
} from '@patternfly/react-icons';
import {
  Grid,
  GridItem,
  Text,
  TextContent,
  Label,
} from '@patternfly/react-core';

interface TopRulesProps {
  top_rules: {
    associated_cves: string[];
    description: string;
    name: string;
    rule_id: string;
    severity: number;
    systems_affected: number;
  }[];
}

const TopCves: React.FC<TopRulesProps> = ({ top_rules }) => (
  <React.Fragment>
    {top_rules.map(
      (
        { associated_cves, description, name, severity, systems_affected },
        index
      ) => (
        <React.Fragment key={index}>
          <TextContent>
            <Text className="pf-u-mb-sm pf-u-color-200 pf-u-font-weight-bold">
              {name}
            </Text>
          </TextContent>
          <Grid className="pf-u-mb-lg" hasGutter>
            <GridItem span={2}>
              <div className="pf-u-color-400">Severity</div>
              {severity === 4 && (
                <Label color="red" icon={<CriticalRiskIcon />}>
                  Critical
                </Label>
              )}
              {severity === 3 && (
                <Label color="orange" icon={<AngleDoubleUpIcon />}>
                  Important
                </Label>
              )}
              {severity === 2 && (
                <Label color="orange" icon={<EqualsIcon />}>
                  Moderate
                </Label>
              )}
              {severity === 1 && (
                <Label color="blue" icon={<AngleDoubleDownIcon />}>
                  Low
                </Label>
              )}
            </GridItem>
            <GridItem span={3}>
              <div className="pf-u-color-400">Systems exposed</div>
              <div className="pf-u-font-weight-bold pf-u-font-size-3xl">
                {systems_affected}
              </div>
            </GridItem>
            <GridItem span={7}>
              <div className="pf-u-mb-lg">{description}</div>
              <div>
                Associated CVEs:{' '}
                {associated_cves.map((cves) => cves).join(', ')}
              </div>
            </GridItem>
          </Grid>
        </React.Fragment>
      )
    )}
  </React.Fragment>
);

export default TopCves;
