import React from 'react';
import {
  Grid,
  GridItem,
  Text,
  TextContent,
  Label,
} from '@patternfly/react-core';

interface TopCvesProps {
  top_cves: {
    cvss2_score: string;
    cvss3_score: string;
    description: string;
    known_exploit: boolean;
    rule_presence: boolean;
    security_rule: boolean;
    synopsis: string;
    systems_affected: number;
  }[];
}

const TopCves: React.FC<TopCvesProps> = ({ top_cves }) => (
  <React.Fragment>
    {top_cves.map(
      (
        {
          cvss3_score,
          description,
          known_exploit,
          rule_presence,
          security_rule,
          synopsis,
          systems_affected,
        },
        index
      ) => (
        <React.Fragment key={index}>
          <TextContent>
            <Text className="pf-u-mb-sm pf-u-color-200 pf-u-font-weight-bold">
              {synopsis}
            </Text>
          </TextContent>
          <Grid className="pf-u-mb-lg" hasGutter>
            <GridItem span={2}>
              <div className="pf-u-color-400">CVSS score</div>
              <div className="pf-u-font-weight-bold pf-u-font-size-3xl">
                {Number.parseFloat(cvss3_score).toFixed(1)}
              </div>
            </GridItem>
            <GridItem span={3}>
              <div className="pf-u-color-400">Systems exposed</div>
              <div className="pf-u-font-weight-bold pf-u-font-size-3xl">
                {systems_affected}
              </div>
            </GridItem>
            <GridItem span={7}>
              {security_rule && (
                <Label className="pf-u-mb-sm pf-u-mr-xs" color="blue">
                  Security rule
                </Label>
              )}
              {rule_presence && (
                <Label className="pf-u-mb-sm pf-u-mr-xs" color="blue">
                  Rule presence
                </Label>
              )}
              {known_exploit && (
                <Label className="pf-u-mb-sm pf-u-mr-xs" color="red">
                  Known exploit
                </Label>
              )}
              <TextContent>
                <Text>{description}</Text>
              </TextContent>
            </GridItem>
          </Grid>
        </React.Fragment>
      )
    )}
  </React.Fragment>
);

export default TopCves;
